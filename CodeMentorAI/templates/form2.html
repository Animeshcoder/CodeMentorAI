<!DOCTYPE html>
<html>

  <head>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/codemirror.min.js"></script>
    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/codemirror.min.css">

  </head>
  <body>
    
      <style>
        body {
            font-family: Arial, sans-serif;
        }
        #form-and-output {
            width: 50%;
            margin: 0 auto;
            padding: 20px;
            background-color: #f2f2f2;
            border-radius: 10px;
        }
        #form-and-output form {
            display: flex;
            flex-direction: column;
        }
        #form-and-output form label {
            margin-bottom: 10px;
            color: #333;
        }
        #form-and-output form select,
        #form-and-output form textarea {
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 16px;
        }
        #form-and-output form input[type="submit"] {
            padding: 10px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        #form-and-output form input[type="submit"]:hover {
            background-color: #0056b3;
        }
        #output {
            margin-top: 20px;
            padding: 20px;
            background-color: #f2f2f2;
            border-radius: 10px;
        }
        #output h2,
        #output h3 {
            color: #333;
        }
        #output p {
            margin-top: 10px;
            color: #666;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        h2 {
            text-align: center;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>CodeMentorAI</h1>
    <h2>Your Personal AI Coding Mentor</h2>
    <div id="form-and-output">
        <!-- <form action="/" method="post">
            <label for="topic">Topics:</label>
            <select id="topic" name="title"></select>
            <label for="question">Question:</label>
            <select id="questions" name="question">
                <option value="NA">---NA---</option>
            </select>
            <label for="code">Code:</label>
            <textarea id="code" name="code"></textarea>
            <input type="submit" value="Submit">
        </form> -->

        <!-- <form action="/" method="post"> -->
        <form action="/" method="post" onsubmit="event.preventDefault(); handleFormSubmit(event);">
          <label for="topic">Topics:</label>
          <select id="topic" name="title">
              <option value="" selected>Select Topic</option>
          </select>
          <label for="question">Question:</label>
          <select id="questions" name="question">
              <option value="" >Select Question</option>
          </select>
          <label for="code">Code:</label>
          <textarea id="code" name="code"></textarea>
          <input type="submit" value="Submit">
        </form>
    </div>
    <div id="output">
        {% if output %}
        <h2>Evaluation</h2>
        <h3>Correctness</h3>
        <p>{{ output.correctness }}</p>
        <h3>Explanation</h3>
        <p>{{ output.explanation }}</p>
        {% endif %}
    </div>
</body>

      
    </div>


    <script>
    var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
      lineNumbers: true,
      mode: "python",
      theme: "monokai"
    });
  </script>

    <script>
    var code = editor.getValue();
    // Send the code to your server for processing
  </script>

    <!--inserting script of reading json file-->
    <script async>
    var data;

    async function response3(){
        let response = await fetch('/static/problems.json');
        let info = await response.json()
        console.log(info)
        data=info;
        options(info)
    }

    response3();

    const topics=document.getElementById('topic');
    const question=document.getElementById('questions')

    function options(obj){
        obj.forEach((item) => {
            let option = document.createElement("option");
            option.value = item.concept;
            option.text=item.title;
            topics.appendChild(option);
        });
    }

    topics.addEventListener('change', function() {
        // Clear the second select box
        question.innerHTML = "";

        // Find the selected topic in the data
        let selectedTopic = data.find(item => item.concept == this.value);

        // Create new option elements from the selected topic's questions for the second select box
        selectedTopic.questions.forEach((que) => {
            let option = document.createElement("option");
            option.setAttribute('id',`${que.number}`)
            option.text = que.text;
            question.appendChild(option);
        });

        question.value = "Select Question";
    });

    </script>

    </body>
</html>